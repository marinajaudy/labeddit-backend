import { GetPostInputDTO } from '../../src/dtos/PostDTO'
import { PostsDatabaseMock } from '../mocks/PostsDatabaseMock'
import { IdGeneratorMock } from '../mocks/IdGeneratorMock'
import { TokenManagerMock } from '../mocks/TokenManagerMock'
import { PostBusiness } from '../../src/business/PostBusiness'
import { UsersDatabaseMock } from '../mocks/UsersDatabaseMock'
import { CommentsDatabaseMock } from '../mocks/CommentsDatabaseMock'

describe("Get Posts", ()=>{
    const postBusiness = new PostBusiness(
        new PostsDatabaseMock(),
        new IdGeneratorMock(),
        new UsersDatabaseMock(),
        new TokenManagerMock()
    )
    
    test("teste de pegar todos os posts", async()=>{
        const input: GetPostInputDTO = {
            token: "token-mock-admin"
        }

        const response = await postBusiness.getPosts(input)
        expect(response).toBe([
            {
                id: "id-mock",
                content: "Que dia mais lindo! Calor, sol e mar...",
                likes: 0,
                dislikes: 0,
                creator: {
                    id: "id-mock2",
                    nickname: "Normal Mock",
                },
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString()
            },
            {
                id: "id-mock1",
                content: "Feliz demais por essa semana! Muitas coisas por vir...",
                likes: 0,
                dislikes: 0,
                creator: {
                    id: "id-mock3",
                    nickname: "Admin Mock",
                },
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString()
            }
        ])

    })
})